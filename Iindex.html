<!doctype html>
<html lang="hr">
<head>
  <meta charset="utf-8"/>
  <title>QuickMIG 300 — Realistični panel + kalkulator</title>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <style>
    :root{
      --panel-w:900px;   /* prilagodi širinu po potrebi */
      --panel-h:620px;   /* odnos slike ~900x620 */
    }
    body { background:#222; display:flex; align-items:center; justify-content:center; min-height:100vh; margin:0; font-family: Inter, system-ui, -apple-system,Segoe UI,Roboto,Arial; color:#fff; }
    .stage { position:relative; width:var(--panel-w); height:var(--panel-h); background:#000; border-radius:8px; box-shadow:0 10px 30px rgba(0,0,0,.6); overflow:hidden; }
    /* background image of QuickMIG panel */
    .panel-bg { position:absolute; inset:0; background-image: url('https://www.unitedwelding.co.uk/ProdImages/11194.jpg'); /* fallback if you downloaded use 'panel.jpg' */ background-size:cover; background-position:center; filter: contrast(.95) saturate(.85); }
    /* overlay controls */
    .led-display { position:absolute; top:58px; left:325px; width:250px; height:56px; display:flex; justify-content:space-between; align-items:center; padding:6px 12px; box-sizing:border-box; }
    .led-num { font-family: "Consolas", "Lucida Console", monospace; font-weight:800; font-size:36px; color:#ff2a2a; text-shadow:0 0 8px rgba(255,40,40,0.8); }
    /* big red knobs */
    .knob { position:absolute; width:96px; height:96px; border-radius:50%; background:linear-gradient(180deg,#cc0000,#8b0000); box-shadow: inset 0 6px 12px rgba(255,255,255,0.06), 0 6px 18px rgba(0,0,0,0.6); display:flex; align-items:center; justify-content:center; cursor:grab; }
    .knob:active{ cursor:grabbing; }
    .knob .mark { width:6px; height:30px; background:#fff; border-radius:3px; transform-origin:center 36px; }
    /* positions roughly matching image */
    /* left knob (Amps) */
    .knob.left { left:210px; top:170px; transform:translate(-50%,-50%); }
    /* center small knob (mid) */
    .knob.center { left:380px; top:210px; width:66px; height:66px; }
    /* right knob (Volt) */
    .knob.right { left:520px; top:172px; transform:translate(-50%,-50%); }

    /* buttons grid under knobs */
    .btn-grid { position:absolute; left:255px; top:270px; width:390px; display:grid; grid-template-columns: repeat(4,1fr); gap:10px; }
    .toggle { background:rgba(0,0,0,0.55); border-radius:6px; padding:10px 6px; text-align:center; font-size:12px; cursor:pointer; color:#ddd; border:2px solid rgba(255,255,255,0.03); box-shadow:inset 0 -3px 6px rgba(0,0,0,0.4); }
    .toggle.active { background:linear-gradient(180deg,#ff2a2a,#b30d0d); color:#fff; box-shadow:0 6px 14px rgba(179,13,13,0.35); border-color:rgba(255,255,255,0.06); }
    /* info badge bottom-right */
    .info-card { position:absolute; right:14px; bottom:18px; width:340px; background:rgba(0,0,0,0.6); border-radius:8px; padding:12px; font-size:13px; color:#fff; box-shadow:0 8px 24px rgba(0,0,0,0.6); }
    .info-row { display:flex; gap:8px; align-items:center; margin-bottom:4px; }
    .info-row small { color:#ddd; width:140px; }
    .meter { font-weight:800; font-size:18px; color:#ff4d4d; text-shadow:0 0 8px rgba(255,77,77,0.6); }

    /* small UI (inputs) overlay for user inputs - transparent to blend */
    .ui-panel { position:absolute; left:14px; top:14px; background:rgba(0,0,0,0.55); padding:10px; border-radius:8px; width:240px; font-size:13px; }
    .ui-panel label{ font-size:12px; color:#ddd; display:block; margin-top:8px; }
    .ui-panel input, .ui-panel select { width:100%; margin-top:6px; padding:6px 8px; border-radius:6px; border:1px solid rgba(255,255,255,0.06); background:rgba(255,255,255,0.03); color:#fff; }
    .btn-calc { margin-top:10px; width:100%; padding:8px; background:#ff2a2a; color:#fff; border:0; border-radius:6px; cursor:pointer; font-weight:700; }

    /* responsive smaller screens */
    @media (max-width:980px){
      :root{ --panel-w:720px; --panel-h:495px; }
      .led-num{ font-size:28px; }
    }

  </style>
</head>
<body>
  <div class="stage" id="stage">
    <div class="panel-bg"></div>

    <!-- small UI overlay for inputs -->
    <div class="ui-panel">
      <div style="font-weight:800;font-size:15px;margin-bottom:6px">QuickMIG 300 — Kalkulator</div>
      <label>Debljina materijala (mm)</label>
      <input id="thickness" type="number" step="0.1" value="2.0" min="0.5">
      <label>Promjer žice</label>
      <select id="wireDia">
        <option value="0.8">0.8 mm</option>
        <option value="1.0" selected>1.0 mm</option>
      </select>
      <label>Tip žice</label>
      <select id="wireType">
        <option value="steel_solid">Mild steel — solid (ER70S-6)</option>
        <option value="steel_co2">Mild steel — 100% CO₂</option>
        <option value="flux_cored">Flux-cored</option>
        <option value="aluminum">Aluminium</option>
      </select>

      <label>Položaj</label>
      <select id="position">
        <option value="flat">Flat</option>
        <option value="horizontal">Horizontal</option>
        <option value="vertical">Vertical</option>
        <option value="overhead">Overhead</option>
      </select>

      <button class="btn-calc" id="calcBtn">Izračunaj</button>
    </div>

    <!-- LED display -->
    <div class="led-display">
      <div class="led-num" id="ledAmp">--</div>
      <div class="led-num" id="ledVolt">--</div>
    </div>

    <!-- knobs (visual) -->
    <div class="knob left" id="knobAmp" title="Amper (ručno)">
      <div class="mark" id="markAmp" style="transform:rotate(-90deg)"></div>
    </div>
    <div class="knob center" id="knobMid" title="Fuj">
      <div class="mark" style="transform:rotate(-90deg)"></div>
    </div>
    <div class="knob right" id="knobVolt" title="Volt (ručno)">
      <div class="mark" id="markVolt" style="transform:rotate(-90deg)"></div>
    </div>

    <!-- buttons grid -->
    <div class="btn-grid" id="btnGrid">
      <div class="toggle" data-key="co2">CO₂</div>
      <div class="toggle" data-key="mix">MIX</div>
      <div class="toggle" data-key="ar">Ar</div>
      <div class="toggle" data-key="solid">Solid</div>

      <div class="toggle" data-key="flux">Flux-cored</div>
      <div class="toggle" data-key="fe">Fe</div>
      <div class="toggle" data-key="al">Al</div>
      <div class="toggle" data-key="ss">Ss</div>
    </div>

    <!-- info card with computed outputs -->
    <div class="info-card" id="infoCard">
      <div class="info-row"><small>Amperaza (A)</small><div class="meter" id="outAmp">-- A</div></div>
      <div class="info-row"><small>Napon (V)</small><div class="meter" id="outVolt">-- V</div></div>
      <div class="info-row"><small>Brzina žice (WFS)</small><div class="meter" id="outWfs">-- m/min</div></div>
      <div class="info-row"><small>Plin & protok</small><div class="meter" id="outGas">--</div></div>
      <div style="font-size:12px;color:#ccc;margin-top:6px">Stick-out preporuka: <strong id="outStick">-- mm</strong></div>
    </div>
  </div>

  <script>
    // Presets / empirijske konstante (isto kao prije)
    const presets = {
      steel_solid: { ampPerMm: 50, vSlope: 0.07, vBase: 14, gas: "Ar/CO₂ 75/25", efficiency: 0.9 },
      steel_co2:   { ampPerMm: 54, vSlope: 0.07, vBase: 14, gas: "100% CO₂", efficiency: 0.9 },
      flux_cored:  { ampPerMm: 58, vSlope: 0.07, vBase: 14.5, gas: "Self-shielded / CO₂", efficiency: 0.95 },
      aluminum:    { ampPerMm: 70, vSlope: 0.06, vBase: 14, gas: "100% Argon", efficiency: 0.85 }
    };
    const wfsFactors = { "0.8": 12, "1.0": 10 };

    // DOM refs
    const ledAmp = document.getElementById('ledAmp');
    const ledVolt = document.getElementById('ledVolt');
    const outAmp = document.getElementById('outAmp');
    const outVolt = document.getElementById('outVolt');
    const outWfs = document.getElementById('outWfs');
    const outGas = document.getElementById('outGas');
    const outStick = document.getElementById('outStick');

    // knobs marks
    const markAmp = document.getElementById('markAmp');
    const markVolt = document.getElementById('markVolt');

    // calculate function (same logic)
    function calcValues(manualAmp=null, manualVolt=null){
      const t = parseFloat(document.getElementById('thickness').value) || 1;
      const wireDia = document.getElementById('wireDia').value;
      const wireType = document.getElementById('wireType').value;
      const pos = document.getElementById('position').value;

      const thickness = Math.max(0.5, Math.min(25, t));
      const p = presets[wireType];

      let posFactor = 1.0;
      if (pos === "vertical") posFactor = 0.88;
      if (pos === "overhead") posFactor = 0.80;
      if (pos === "horizontal") posFactor = 0.95;

      let amps = Math.round(p.ampPerMm * thickness * posFactor);
      let volts = Math.round((p.vBase + p.vSlope * amps) * 10)/10;

      // if manual knobs used, accept them (overrides)
      if (manualAmp !== null) amps = Math.round(manualAmp);
      if (manualVolt !== null) volts = Math.round(manualVolt * 10)/10;

      const factor = wfsFactors[wireDia] || 10;
      let wfs_m_min = Math.round((amps / factor) * 10)/10;
      if (wfs_m_min < 0.5) wfs_m_min = Math.round(wfs_m_min*10)/10;

      let gasFlow = 12;
      if (wireType === "aluminum") gasFlow = 14;
      if (wireType === "flux_cored") gasFlow = 10;
      if (wireDia === "1.0") gasFlow += 1;

      const stickOutRec = 12;

      // Update UI
      ledAmp.textContent = amps + " A";
      ledVolt.textContent = volts + " V";
      outAmp.textContent = amps + " A";
      outVolt.textContent = volts + " V";
      outWfs.textContent = wfs_m_min + " m/min";
      outGas.textContent = p.gas + " — " + gasFlow + " L/min";
      outStick.textContent = stickOutRec + " mm";

      // rotate knobs' mark to reflect values (map amps->angle)
      // Angle mapping: min 0 -> -110deg, max 350 -> +110deg (clamped)
      const ampAngle = Math.max(-120, Math.min(120, (amps - 20) * 0.9 - 90));
      const voltAngle = Math.max(-120, Math.min(120, (volts - 10) * 12 - 90));
      markAmp.style.transform = `rotate(${ampAngle}deg)`;
      markVolt.style.transform = `rotate(${voltAngle}deg)`;
    }

    document.getElementById('calcBtn').addEventListener('click', ()=>calcValues());

    // button toggles under panel for visuals
    document.getElementById('btnGrid').querySelectorAll('.toggle').forEach(b=>{
      b.addEventListener('click', ()=> b.classList.toggle('active'));
    });

    // Basic knob dragging for manual override (simple implementation)
    function makeKnob(el, onChange){
      let dragging=false, startY=0, startVal=0;
      el.addEventListener('pointerdown', (e)=>{
        dragging=true; startY=e.clientY;
        el.setPointerCapture(e.pointerId);
      });
      window.addEventListener('pointermove', (e)=>{
        if(!dragging) return;
        const dy = (startY - e.clientY); // up -> increase
        const delta = Math.round(dy * 0.6);
        onChange(delta);
      });
      window.addEventListener('pointerup', (e)=>{
        dragging=false;
      });
    }

    // current manual offsets
    let manualAmpOffset = 0;
    let manualVoltOffset = 0;

    // attach knobs: moving changes offsets and recalculates
    makeKnob(document.getElementById('knobAmp'), (delta)=>{
      // delta approximate A change
      manualAmpOffset = delta;
      // compute default amps then add offset
      const t = parseFloat(document.getElementById('thickness').value) || 1;
      const p = presets[document.getElementById('wireType').value];
      let posFactor = 1.0;
      const pos = document.getElementById('position').value;
      if (pos === "vertical") posFactor = 0.88;
      if (pos === "overhead") posFactor = 0.80;
      if (pos === "horizontal") posFactor = 0.95;
      const baseAmp = Math.round(p.ampPerMm * Math.max(0.5, Math.min(25,t)) * posFactor);
      calcValues(baseAmp + manualAmpOffset, null);
    });
    makeKnob(document.getElementById('knobVolt'), (delta)=>{
      manualVoltOffset = delta/6; // smaller effect
      // compute default volts then add offset
      const t = parseFloat(document.getElementById('thickness').value) || 1;
      const p = presets[document.getElementById('wireType').value];
      let posFactor = 1.0;
      const pos = document.getElementById('position').value;
      if (pos === "vertical") posFactor = 0.88;
      if (pos === "overhead") posFactor = 0.80;
      if (pos === "horizontal") posFactor = 0.95;
      const baseAmp = Math.round(p.ampPerMm * Math.max(0.5, Math.min(25,t)) * posFactor);
      const baseVolt = Math.round((p.vBase + p.vSlope * baseAmp) * 10)/10;
      calcValues(null, baseVolt + manualVoltOffset);
    });

    // initial calc
    calcValues();

    // optional: if user changes inputs, recalc with knobs reset
    ['thickness','wireDia','wireType','position'].forEach(id=>{
      document.getElementById(id).addEventListener('change', ()=>{
        manualAmpOffset = 0; manualVoltOffset = 0;
        calcValues();
      });
    });

  </script>

</body>

</html>
